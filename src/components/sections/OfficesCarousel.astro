---
// OfficesCarousel.astro - Carrusel de oficinas
---

<!-- Contamos con oficinas en -->
<section class="bg-servir-blue py-16 md:py-20 relative">
    <div class="max-w-7xl mx-auto px-4">
        <!-- Título con fondo blanco redondo en la parte superior -->
        <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
            <div class="bg-white rounded-full px-12 py-6 shadow-lg">
                <h2 class="text-xl md:text-2xl lg:text-3xl font-bold whitespace-nowrap text-servir-blue">
                    Contamos con oficinas en:
                </h2>
            </div>
        </div>

        <!-- Espaciado para el título -->
        <div class="pt-12 md:pt-16"></div>

        <!-- Carrusel de Cards de Oficinas -->
        <div class="relative">
            <!-- Contenedor del carrusel -->
            <div class="overflow-hidden" id="carousel-container">
                <div id="offices-carousel" class="flex transition-transform duration-300 ease-in-out">

                    <!-- Card CC. Viva Envigado -->
                    <div class="flex-none w-full sm:w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 mx-2">
                        <div
                            class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 h-96 sm:h-80 md:h-96 lg:h-80">
                            <div class="flex flex-col sm:flex-row h-full">
                                <!-- Carrusel de imágenes (izquierda) -->
                                <div class="w-full sm:w-1/2 h-1/2 sm:h-full relative p-3">
                                    <div class="relative h-full rounded-lg overflow-hidden">
                                        <div id="envigado-images"
                                            class="flex h-full transition-transform duration-300 ease-in-out"
                                            style="width: 300%;">
                                            <img src="https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=400&h=300&fit=crop"
                                                alt="CC. Viva Envigado 1" class="flex-none h-full object-cover"
                                                style="width: 33.333%;">
                                            <img src="https://images.unsplash.com/photo-1497366216548-37526070297c?w=400&h=300&fit=crop"
                                                alt="CC. Viva Envigado 2" class="flex-none h-full object-cover"
                                                style="width: 33.333%;">
                                            <img src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=400&h=300&fit=crop"
                                                alt="CC. Viva Envigado 3" class="flex-none h-full object-cover"
                                                style="width: 33.333%;">
                                        </div>
                                    </div>
                                    <!-- Controles del carrusel de imágenes -->
                                    <button onclick="previousImage('envigado')"
                                        class="absolute left-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-all">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                        </svg>
                                    </button>
                                    <button onclick="nextImage('envigado')"
                                        class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-all">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="2" d="M9 5l7 7-7 7"></path>
                                        </svg>
                                    </button>
                                </div>

                                <!-- Contenido de la card (derecha) -->
                                <div
                                    class="w-full sm:w-1/2 h-1/2 sm:h-full p-4 sm:p-6 flex flex-col justify-center items-center text-center">
                                    <h3 class="text-xl md:text-2xl font-bold mb-3" style="color: #385D83;">
                                        CC. Viva Envigado</h3>
                                    <a href="https://maps.app.goo.gl/4ik33Hfv3dbTHbFv9" target="_blank"
                                        class="inline-block bg-gray-300 text-black py-2 px-6 rounded-full font-semibold hover:bg-gray-400 transition-colors text-sm md:text-base">
                                        Ver ubicación
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Card Oficina en Medellín -->
                    <div class="flex-none w-full sm:w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 mx-2">
                        <div
                            class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 h-96 sm:h-80 md:h-96 lg:h-80">
                            <div class="flex flex-col sm:flex-row h-full">
                                <!-- Carrusel de imágenes (izquierda) -->
                                <div class="w-full sm:w-1/2 h-1/2 sm:h-full relative p-3">
                                    <div class="relative h-full rounded-lg overflow-hidden">
                                        <div id="medellin-images"
                                            class="flex h-full transition-transform duration-300 ease-in-out"
                                            style="width: 300%;">
                                            <img src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=400&h=300&fit=crop"
                                                alt="Oficina Medellín 1" class="flex-none h-full object-cover"
                                                style="width: 33.333%;">
                                            <img src="https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=400&h=300&fit=crop"
                                                alt="Oficina Medellín 2" class="flex-none h-full object-cover"
                                                style="width: 33.333%;">
                                            <img src="https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=400&h=300&fit=crop"
                                                alt="Oficina Medellín 3" class="flex-none h-full object-cover"
                                                style="width: 33.333%;">
                                        </div>
                                    </div>
                                    <!-- Controles del carrusel de imágenes -->
                                    <button onclick="previousImage('medellin')"
                                        class="absolute left-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-all">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                        </svg>
                                    </button>
                                    <button onclick="nextImage('medellin')"
                                        class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-all">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="2" d="M9 5l7 7-7 7"></path>
                                        </svg>
                                    </button>
                                </div>

                                <!-- Contenido de la card (derecha) -->
                                <div
                                    class="w-full sm:w-1/2 h-1/2 sm:h-full p-4 sm:p-6 flex flex-col justify-center items-center text-center">
                                    <h3 class="text-xl md:text-2xl font-bold mb-3" style="color: #385D83;">
                                        Oficina en Medellín</h3>
                                    <p class="text-gray-600 mb-2 text-sm md:text-base">Carrera 51 #45-75</p>
                                    <p class="text-gray-600 mb-2 text-sm md:text-base">CC. Pioneros - Local 213</p>
                                    <p class="text-gray-600 mb-4 text-sm md:text-base">Centro de Medellín, La Candelaria</p>
                                    <a href="https://maps.app.goo.gl/UXmTfssLjFP8LqVY9?g_st=awb" target="_blank"
                                        class="inline-block bg-gray-300 text-black py-2 px-6 rounded-full font-semibold hover:bg-gray-400 transition-colors text-sm md:text-base">
                                        Ver ubicación
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Card Oficina en Bogotá -->
                    <div class="flex-none w-full sm:w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 mx-2">
                        <div
                            class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 h-96 sm:h-80 md:h-96 lg:h-80">
                            <div class="flex flex-col sm:flex-row h-full">
                                <!-- Carrusel de imágenes (izquierda) -->
                                <div class="w-full sm:w-1/2 h-1/2 sm:h-full relative p-3">
                                    <div class="relative h-full rounded-lg overflow-hidden">
                                        <div id="bogota-images"
                                            class="flex h-full transition-transform duration-300 ease-in-out"
                                            style="width: 300%;">
                                            <img src="https://images.unsplash.com/photo-1497366216548-37526070297c?w=400&h=300&fit=crop"
                                                alt="Oficina Bogotá 1" class="flex-none h-full object-cover"
                                                style="width: 33.333%;">
                                            <img src="https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=400&h=300&fit=crop"
                                                alt="Oficina Bogotá 2" class="flex-none h-full object-cover"
                                                style="width: 33.333%;">
                                            <img src="https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=400&h=300&fit=crop"
                                                alt="Oficina Bogotá 3" class="flex-none h-full object-cover"
                                                style="width: 33.333%;">
                                        </div>
                                    </div>
                                    <!-- Controles del carrusel de imágenes -->
                                    <button onclick="previousImage('bogota')"
                                        class="absolute left-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-all">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                        </svg>
                                    </button>
                                    <button onclick="nextImage('bogota')"
                                        class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-all">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="2" d="M9 5l7 7-7 7"></path>
                                        </svg>
                                    </button>
                                </div>

                                <!-- Contenido de la card (derecha) -->
                                <div
                                    class="w-full sm:w-1/2 h-1/2 sm:h-full p-4 sm:p-6 flex flex-col justify-center items-center text-center">
                                    <h3 class="text-xl md:text-2xl font-bold mb-3" style="color: #385D83;">
                                        Oficina en Bogotá</h3>
                                    <p class="text-gray-600 mb-2 text-sm md:text-base">Calle 13# 15-73</p>
                                    <p class="text-gray-600 mb-2 text-sm md:text-base">CC. Nodo Móvil 13G - Oficina 206</p>
                                    <p class="text-gray-600 mb-4 text-sm md:text-base">Centro de Bogotá, Los Mártires</p>
                                    <a href="https://maps.app.goo.gl/xWVsig6u2rkvhwZ19?g_st=awb" target="_blank"
                                        class="inline-block bg-gray-300 text-black py-2 px-6 rounded-full font-semibold hover:bg-gray-400 transition-colors text-sm md:text-base">
                                        Ver ubicación
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Card Oficina en Pereira -->
                    <div class="flex-none w-full sm:w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 mx-2">
                        <div
                            class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 h-96 sm:h-80 md:h-96 lg:h-80">
                            <div class="flex flex-col sm:flex-row h-full">
                                <!-- Carrusel de imágenes (izquierda) -->
                                <div class="w-full sm:w-1/2 h-1/2 sm:h-full relative p-3">
                                    <div class="relative h-full rounded-lg overflow-hidden">
                                        <div id="pereira-images"
                                            class="flex h-full transition-transform duration-300 ease-in-out"
                                            style="width: 300%;">
                                            <img src="https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=400&h=300&fit=crop"
                                                alt="Oficina Pereira 1"
                                                class="flex-none h-full object-cover" style="width: 33.333%;">
                                            <img src="https://images.unsplash.com/photo-1497366216548-37526070297c?w=400&h=300&fit=crop"
                                                alt="Oficina Pereira 2"
                                                class="flex-none h-full object-cover" style="width: 33.333%;">
                                            <img src="https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=400&h=300&fit=crop"
                                                alt="Oficina Pereira 3"
                                                class="flex-none h-full object-cover" style="width: 33.333%;">
                                        </div>
                                    </div>
                                    <!-- Controles del carrusel de imágenes -->
                                    <button onclick="previousImage('pereira')"
                                        class="absolute left-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-all">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                        </svg>
                                    </button>
                                    <button onclick="nextImage('pereira')"
                                        class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-all">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                stroke-width="2" d="M9 5l7 7-7 7"></path>
                                        </svg>
                                    </button>
                                </div>

                                <!-- Contenido de la card (derecha) -->
                                <div
                                    class="w-full sm:w-1/2 h-1/2 sm:h-full p-4 sm:p-6 flex flex-col justify-center items-center text-center">
                                    <h3 class="text-xl md:text-2xl font-bold mb-3" style="color: #385D83;">
                                        Oficina en Pereira</h3>
                                    <p class="text-gray-600 mb-2 text-sm md:text-base">Carrera 8#19-41</p>
                                    <p class="text-gray-600 mb-2 text-sm md:text-base">CC. Bolívar Plaza- Local 118</p>
                                    <p class="text-gray-600 mb-4 text-sm md:text-base">Plaza Bolívar, Pereira</p>
                                    <a href="https://maps.app.goo.gl/hCAJopm3WZTepwaY9?g_st=ic"
                                        target="_blank"
                                        class="inline-block bg-gray-300 text-black py-2 px-6 rounded-full font-semibold hover:bg-gray-400 transition-colors text-sm md:text-base">
                                        Ver ubicación
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Botones de navegación en la parte inferior -->
            <div class="flex justify-center mt-8 space-x-4">
                <button
                    class="carousel-btn w-4 h-4 rounded-full bg-blue-600 shadow-lg border-2 border-white transition-all duration-300 hover:bg-blue-700 hover:scale-110 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50"></button>
                <button
                    class="carousel-btn w-4 h-4 rounded-full bg-gray-300 shadow-md border-2 border-white transition-all duration-300 hover:bg-gray-400 hover:scale-110 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50"></button>
                <button
                    class="carousel-btn w-4 h-4 rounded-full bg-gray-300 shadow-md border-2 border-white transition-all duration-300 hover:bg-gray-400 hover:scale-110 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50"></button>
                <button
                    class="carousel-btn w-4 h-4 rounded-full bg-gray-300 shadow-md border-2 border-white transition-all duration-300 hover:bg-gray-400 hover:scale-110 hover:shadow-lg focus:outline-next focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50"></button>
            </div>
        </div>
    </div>
</section>

<script>
    // Variables globales para el carrusel principal
    let currentOfficeIndex = 0;
    const totalOffices = 4;

    // Variables para los carruseles de imágenes de cada oficina
    const imageIndexes = {
        'envigado': 0,
        'medellin': 0,
        'bogota': 0,
        'pereira': 0
    };

    // Función para cambiar de oficina
    function changeOffice(index) {
        currentOfficeIndex = index;
        const carousel = document.getElementById('offices-carousel');
        const container = document.getElementById('carousel-container');
        
        // Obtener el ancho del contenedor
        const containerWidth = container.offsetWidth;
        
        // Calcular el ancho de cada card incluyendo márgenes
        // Cada card tiene mx-2 (16px de margen total) y diferentes anchos responsivos
        const cards = carousel.children;
        let totalOffset = 0;
        
        for (let i = 0; i < index; i++) {
            totalOffset += cards[i].offsetWidth + 16; // 16px = mx-2 (8px cada lado)
        }
        
        carousel.style.transform = `translateX(-${totalOffset}px)`;
        
        // Actualizar indicadores
        updateCarouselIndicators();
    }

    // Función para actualizar los indicadores del carrusel principal
    function updateCarouselIndicators() {
        const buttons = document.querySelectorAll('.carousel-btn');
        buttons.forEach((btn, index) => {
            if (index === currentOfficeIndex) {
                btn.classList.remove('bg-gray-300');
                btn.classList.add('bg-blue-600');
            } else {
                btn.classList.remove('bg-blue-600');
                btn.classList.add('bg-gray-300');
            }
        });
    }

    // Función para cambiar imagen anterior en el carrusel de fotos
    function previousImage(office) {
        const currentIndex = imageIndexes[office];
        const newIndex = currentIndex === 0 ? 2 : currentIndex - 1;
        imageIndexes[office] = newIndex;
        
        const imageCarousel = document.getElementById(`${office}-images`);
        const translateX = -newIndex * 33.333;
        imageCarousel.style.transform = `translateX(${translateX}%)`;
    }

    // Función para cambiar imagen siguiente en el carrusel de fotos
    function nextImage(office) {
        const currentIndex = imageIndexes[office];
        const newIndex = currentIndex === 2 ? 0 : currentIndex + 1;
        imageIndexes[office] = newIndex;
        
        const imageCarousel = document.getElementById(`${office}-images`);
        const translateX = -newIndex * 33.333;
        imageCarousel.style.transform = `translateX(${translateX}%)`;
    }

    // Inicializar el carrusel cuando se carga la página
    document.addEventListener('DOMContentLoaded', function() {
        // Configurar los botones indicadores del carrusel principal
        const carouselButtons = document.querySelectorAll('.carousel-btn');
        carouselButtons.forEach((btn, index) => {
            btn.addEventListener('click', () => changeOffice(index));
        });

        // Inicializar el primer indicador como activo
        updateCarouselIndicators();
    });

    // Hacer las funciones globales para que funcionen con onclick
    window.previousImage = previousImage;
    window.nextImage = nextImage;
    window.changeOffice = changeOffice;
</script>